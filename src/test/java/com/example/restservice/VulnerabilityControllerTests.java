package com.example.restservice;

import org.assertj.core.util.Arrays;
import org.junit.jupiter.api.Test;

import java.util.List;

public class VulnerabilityControllerTests {

    @Test
    void returns_location_passed_in() {
        VulnerabilityLocation location = new VulnerabilityLocation("http://www.google.com",
                VulnerabilityLocationKind.URL);

        VulnerabilityController vulnerabilityController = new VulnerabilityController();
        VulnerabilityLocation retVal = vulnerabilityController.location(location);
        assert retVal.location().equals(location.location());
    }

    @Test
    void validates_locationKind_is_URL() {
        VulnerabilityLocation location = new VulnerabilityLocation("http://www.google.com",
                VulnerabilityLocationKind.URL);

        VulnerabilityController vulnerabilityController = new VulnerabilityController();
        VulnerabilityLocation retVal = vulnerabilityController.location(location);
        assert retVal.locationKind().equals(VulnerabilityLocationKind.URL);
    }

    @Test
    void corrects_locationKindURL_for_nonURL() {
        VulnerabilityLocation location =
                new VulnerabilityLocation("This is not really a URL",
                VulnerabilityLocationKind.URL);

        VulnerabilityController vulnerabilityController = new VulnerabilityController();
        VulnerabilityLocation retVal = vulnerabilityController.location(location);
        assert (retVal.locationKind().equals(VulnerabilityLocationKind.UNDETERMINED));
    }

    @Test
    void adds_urls_to_list_and_returns_list() {
        List<String> urls = List.of("http://www.google.com",
                "http://www.amazon.com", "http://www.facebook.com");

        VulnerabilityController vulnerabilityController = new VulnerabilityController();
        for (String l : urls) {
            VulnerabilityLocation vL = new VulnerabilityLocation(l, VulnerabilityLocationKind.URL);
            vulnerabilityController.location(vL);
        }

        List<String> retVal = vulnerabilityController.listVulnerabilities();
        assert retVal.equals(urls);
    }

}
