package com.example.restservice;

import org.junit.jupiter.api.Test;

public class VulnerabilityControllerTests {

    @Test
    void returns_location_passed_in() {
        VulnerabilityLocation location = new VulnerabilityLocation("http://www.google.com",
                VulnerabilityLocationKind.URL);

        VulnerabilityController vulnerabilityController = new VulnerabilityController();
        VulnerabilityLocation retVal = vulnerabilityController.location(location);
        assert retVal.location().equals(location.location());
    }

    void validates_locationKind_is_URL() {
        VulnerabilityLocation location = new VulnerabilityLocation("http://www.google.com",
                VulnerabilityLocationKind.URL);

        VulnerabilityController vulnerabilityController = new VulnerabilityController();
        VulnerabilityLocation retVal = vulnerabilityController.location(location);
        assert retVal.locationKind().equals(VulnerabilityLocationKind.URL);
    }

    void corrects_locationKindURL_for_nonURL() {
        VulnerabilityLocation location =
                new VulnerabilityLocation("This is not really a URL",
                VulnerabilityLocationKind.URL);

        VulnerabilityController vulnerabilityController = new VulnerabilityController();
        VulnerabilityLocation retVal = vulnerabilityController.location(location);
        assert (retVal.locationKind().equals(VulnerabilityLocationKind.UNDETERMINED));
    }

}
