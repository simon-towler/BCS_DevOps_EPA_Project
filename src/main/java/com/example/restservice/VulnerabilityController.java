package com.example.restservice;

import org.springframework.web.bind.annotation.*;

import java.net.MalformedURLException;
import java.net.URISyntaxException;
import java.net.URL;
import java.util.logging.Level;
import java.util.logging.Logger;

@RestController
public class VulnerabilityController {
    private static final Logger LOGGER = Logger.getLogger( VulnerabilityController.class.getName() );
    @PostMapping(value={"/vulnerability"})
    public VulnerabilityLocation location(@RequestBody VulnerabilityLocation location) {
        try {
            new URL(location.location()).toURI();
            return new VulnerabilityLocation(location.location(),
                    VulnerabilityLocationKind.URL);
        } catch (MalformedURLException | URISyntaxException e) {
            LOGGER.log(Level.WARNING,
                    "Vulnerability location kind was not url: {}", location.location());
            return new VulnerabilityLocation(location.location(),
                    VulnerabilityLocationKind.UNDETERMINED);
        }
    }

}
